sudo: false

language: java

jdk:
- oraclejdk8

notifications:
  email:
  - builds@fitbur.com
  on-success: change
  on-failure: always

cache:
    apt: true
    directories:
        - $HOME/.m2

addons:
    apt:
        packages:
            - gnupg

before_install:
    - openssl aes-256-cbc -K $encrypted_2d3d77b456af_key -iv $encrypted_2d3d77b456af_iv -in secrets.tar.enc -out secrets.tar -d
    - tar xvf secrets.tar
    - pip install --user codecov

install:
    - mvn install --settings settings.xml -DskipTests=true -Dmaven.javadoc.skip=true -B -V
    - mvn test --settings settings.xml -B

after_success:
    - codecov
    - deploy.sh
